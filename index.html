<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns:d="http://docbook.org/ns/docbook">Anaconda Addon Development Guide</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.2.6" /><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content="Fedora-Anaconda_Addon_Development_Guide-21-en-US-1-0" /><meta name="description" content="The Anaconda installer is a piece of software used to install Fedora, RHEL and their derivatives. Since the installation is internally a complicated process and there are many aspects of the resulting system that need to be configured during installation it has been decided that the Anaconda installer needs to support dynamically loaded plugins (addons) that will be developed and maintained by other teams and people specialized in certain areas. This guide should help those people writting an Anaconda addon to get an insight to the architecture and basic principles used by the Anaconda installer as well as an overview of the API and helper functions provided." /><link rel="home" href="index.html" title="Anaconda Addon Development Guide" /><link rel="next" href="section_architecture.html" title="2. Architecture" /></head><body class="draft "><p id="title"><a class="left" href="http://www.fedoraproject.org"><img alt="Product Site" src="Common_Content/images//image_left.png" /></a><a class="right" href="http://docs.fedoraproject.org"><img alt="Documentation Site" src="Common_Content/images//image_right.png" /></a></p><ul class="docnav top"><li class="previous"></li><li class="home">Anaconda Addon Development Guide</li><li class="next"><a accesskey="n" href="section_architecture.html"><strong>Next</strong></a></li></ul><div xml:lang="en-US" class="article" lang="en-US"><div class="titlepage"><div><div class="producttitle" font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" font-size="12pt" text-align="center"><span xmlns:d="http://docbook.org/ns/docbook" class="productname">Fedora</span> <span xmlns:d="http://docbook.org/ns/docbook" class="productnumber">21</span></div><div><h2 class="title"><a id="idm242243151024">
      ⁠</a>Anaconda Addon Development Guide</h2></div><div><h3 class="subtitle"><em>Things one needs to know when writing an Anaconda installer Addon</em></h3></div><div><h3 class="corpauthor">
		<span class="inlinemediaobject"><object data="Common_Content/images/title_logo.svg" type="image/svg+xml"><img src="Common_Content/images/title_logo.png" alt="" /></object></span>

	</h3></div><div><div xml:lang="en-US" class="authorgroup" lang="en-US"><div class="author"><h3 class="author"><span class="firstname">Vratislav</span> <span class="surname">Podzimek</span></h3><code class="email"><a class="email" href="mailto:vpodzime@redhat.com">vpodzime@redhat.com</a></code></div></div></div><div><div class="legalnotice"><a id="idm242230811520"></a><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"></span>© 2013 Fedora Project Contributors.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. The original authors of this document, and Red Hat, designate the Fedora Project as the "Attribution Party" for purposes of CC-BY-SA. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, JBoss, MetaMatrix, Fedora, the Infinity Logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		For guidelines on the permitted uses of the Fedora trademarks, refer to <a href="https://fedoraproject.org/wiki/Legal:Trademark_guidelines">https://fedoraproject.org/wiki/Legal:Trademark_guidelines</a>.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
			The Anaconda installer is a piece of software used to install Fedora, RHEL and their derivatives. Since the installation is internally a complicated process and there are many aspects of the resulting system that need to be configured during installation it has been decided that the Anaconda installer needs to support dynamically loaded plugins (addons) that will be developed and maintained by other teams and people specialized in certain areas. This guide should help those people writting an Anaconda addon to get an insight to the architecture and basic principles used by the Anaconda installer as well as an overview of the API and helper functions provided.
		</div></div></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="index.html#section_introduction">1. Introduction</a></span></dt><dt><span class="section"><a href="section_architecture.html">2. Architecture</a></span></dt><dt><span class="section"><a href="section_hub_and_spoke.html">3. Hub&amp;Spoke model</a></span></dt><dt><span class="section"><a href="section_threads_and_communication.html">4. Threads and communication</a></span></dt><dt><span class="section"><a href="section_addon_structure.html">5. Addon structure</a></span></dt><dt><span class="section"><a href="section_writing_addon.html">6. Writing an Anaconda addon</a></span></dt><dd><dl><dt><span class="section"><a href="section_writing_addon.html#section_kickstart_support">6.1. Kickstart support</a></span></dt><dt><span class="section"><a href="section_gui_support.html">6.2. Graphical user interface</a></span></dt><dt><span class="section"><a href="section_tui.html">6.3. Textual user interface</a></span></dt></dl></dd><dt><span class="section"><a href="section_deploying_and_testing.html">7. Deploying and testing an Anaconda addon</a></span></dt><dt><span class="section"><a href="section_final_words.html">8. Addons welcomed</a></span></dt><dt><span class="appendix"><a href="appe-Anaconda_Addon_Development_Guide-Revision_History.html">A. Revision History</a></span></dt><dt><span class="index"><a href="ix01.html">Index</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="section_introduction">
      ⁠</a>1. Introduction</h2></div></div></div><div class="para">
			Anaconda<a id="idx_anaconda" class="indexterm"></a> is the operating system installer (OS) used in Fedora, RHEL and their derivatives. At a closer look, it is a set of Python modules and scripts together with some additional files like Gtk widgets (written in C), systemd units and dracut libraries. Altogether they form a tool that allows users to set parameters of the resulting (target) system and then set such a system up on a machine. The final installation process has four major steps:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					installation destination preparation (usually disk partitioning)
				</div></li><li class="listitem"><div class="para">
					package and data installation
				</div></li><li class="listitem"><div class="para">
					boot loader installation and configuration
				</div></li><li class="listitem"><div class="para">
					configuration of the newly installed system
				</div></li></ul></div><div class="para">
			There are three ways the user can set parameters for the target system (and in some cases also for the installation process). The most commonly used is via the graphical user interface (GUI) <a id="idx_gui" class="indexterm"></a> which should cover all common use cases and should be clear and easily understandable even for non-advanced users. Although Anaconda also supports installation over VNC <a id="idx_vnc" class="indexterm"></a>, there are some corner cases where a textual interface is needed, such as installation over serial console on "exotic" pieces of hardware. For this reason, Anaconda also has a textual user interface (TUI) <a id="idx_tui" class="indexterm"></a> that works the same way as a black-only line printer. This behavior was chosen as a result of various serial consoles not supporting cursor movement, colors and other "advanced" features. Text mode installation implements only the most important features of the graphical installation and usually needs to be combined with installer-specific command line arguments since it does not provide all of the options the GUI provides. The third and most advanced way to set installation parameters is by using a kickstart file. <a id="idx_kickstart" class="indexterm"></a> This is a simple file with shell-like syntax which can contain data driving the installation process, which then runs automatically. If the kickstart file doesn't contain all data required, the installer asks the user about the missing pieces. More information about kickstart can be found at <a href="http://fedoraproject.org/wiki/Anaconda/Kickstart">the Anaconda/Kickstart wiki page</a>. Addons related kickstart specifications are covered in <a class="xref" href="section_addon_structure.html">Section 5, “Addon structure”</a>. The important distinction to note is that, compared to the TUI, which is not a full-featured mode of installation, kickstart installation provides the highest number of configuration options. The golden rule is that everything has to be supported in kickstart first. Then the GUI and TUI pieces can follow, supporting subsets of configuration options provided in kickstart that allow the user interface (UI) to remain clear and succinct. Anaconda has to maintain a balance between simplicity and complexity which is difficult to achieve.
		</div><div class="para">
			It should be clear by now that there are many things which need to happen during the installation process. Many teams and individuals favor the idea of adding more options to the installer so the target system can be pre-configured before it is run for the first time. On one hand, the installation environment is quite specific, and commonly used tools utilized by Anaconda are not always ready to work in it. On the other hand, once a feature is supported via kickstart, multiple systems with the same configuration can be installed easily. However, the more code in the installer, the more bugs it contains. Moreover, the maintenance becomes increasingly difficult with additional functionality, which makes it difficult to follow changes in so many areas. For these reasons, it was decided when doing a major rewrite of the Anaconda installer, support for addons <a id="idx_addon" class="indexterm"></a> must be added. This allows other teams and individuals to participate and contribute as experts in their particular areas of interest by developing and maintaining their own pieces of code. This guide is intended to serve as a tool for lowering the barrier to entry by providing an understanding of how the Anaconda installer works and looks like internally, as well as explaining how its functionality can be extended with an addon.
		</div><div class="para">
			Traditionally, the first boot of the newly installed system is also considered to be a part of the installation procedure--usually, some configuration of the system (e.g. user creation) is taking place at this point. For many years there has been a graphical tool called <a href="http://fedoraproject.org/wiki/FirstBoot">Firstboot</a> <a id="idx_firstboot" class="indexterm"></a>, which has helped users configure some aspects of the newly installed system. The issue with Firstboot is that it is using Gtk2 and the pygtk module, which are both no longer being developed. Since the goal was to provide all existing options from Firstboot during the installation process, it was obvious that the rewritten Firstboot should be sharing code with the Anaconda installer. <a id="idm242243207920">
      ⁠</a><a xmlns:d="http://docbook.org/ns/docbook" href="#ftn.idm242243207920" class="footnote"><sup class="footnote">[1]</sup></a> That is how a new tool called <a href="http://fedoraproject.org/wiki/Features/NewFirstboot"> Initial Setup</a> <a id="idx_is" class="indexterm"></a> was born. It reuses a lot of code from the installer: it has the same model and design as anaconda, and it reads data produced by the installer to show which values are set during the installation process. Most noteworthy is that only a little is needed for an Anaconda addon to become an Initial Setup addon. This is explained in more detail in <a class="xref" href="section_writing_addon.html">Section 6, “Writing an Anaconda addon”</a>.
		</div><div class="para">
			Some additional information about the Anaconda installer can be found at <a href="http://fedoraproject.org/wiki/Anaconda">the Anaconda wiki page</a>, and additional information about the rewrite can be found at <a href="https://fedoraproject.org/wiki/Anaconda/NewInstaller">the Anaconda/NewInstaller wiki page</a>.
		</div></div><div class="footnotes"><br /><hr /><div id="ftn.idm242243207920" class="footnote"><div class="para"><a href="#idm242243207920" class="para"><sup class="para">[1] </sup></a>
				At the same time, it was obvious that the old Firstboot had to be kept working because of the third-party modules written for it.
			</div></div></div></div><ul class="docnav"><li class="previous"></li><li class="next"><a accesskey="n" href="section_architecture.html"><strong>Next</strong>2. Architecture</a></li></ul></body></html>